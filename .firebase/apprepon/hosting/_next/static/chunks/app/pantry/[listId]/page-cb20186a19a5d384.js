(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[859],{285:(e,a,s)=>{"use strict";s.d(a,{$:()=>d});var t=s(5155),r=s(2115),i=s(4253),n=s(2085),l=s(9434);let o=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef((e,a)=>{let{className:s,variant:r,size:n,asChild:d=!1,...c}=e,u=d?i.DX:"button";return(0,t.jsx)(u,{className:(0,l.cn)(o({variant:r,size:n,className:s})),ref:a,...c})});d.displayName="Button"},4430:(e,a,s)=>{"use strict";s.d(a,{CI:()=>l,G6:()=>n,hg:()=>o});var t=s(3004),r=s(5813);let i=new t.HF,n=async()=>{try{return(await (0,t.df)(r.j,i)).user}catch(e){if(console.error("Error durante el inicio de sesi\xf3n con Google:",e),"auth/popup-blocked"===e.code)throw Error("El popup de inicio de sesi\xc3\xb3n fue bloqueado por el navegador. Por favor, habilita los popups para este sitio.");if("auth/unauthorized-domain"===e.code)throw Error("Este dominio no est\xe1 autorizado para el inicio de sesi\xf3n. Revisa la configuraci\xf3n de autenticaci\xf3n en tu proyecto de Firebase y aseg\xfarate de que el dominio actual est\xe9 en la lista de dominios autorizados.");throw Error("Ocurri\xf3 un error inesperado al intentar iniciar sesi\xf3n: ".concat(e.message))}},l=async()=>{try{await (0,t.CI)(r.j)}catch(e){console.error("Error al cerrar sesi\xf3n:",e)}},o=e=>(0,t.hg)(r.j,e)},5544:(e,a,s)=>{"use strict";s.d(a,{A:()=>c,AuthProvider:()=>d});var t=s(5155),r=s(2115),i=s(4430),n=s(172),l=s(6766);let o=(0,r.createContext)(void 0);function d(e){let{children:a}=e,[s,d]=(0,r.useState)(null),[c,u]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{let e=(0,i.hg)(e=>{d(e),u(!1)});return()=>e()},[]),c)?(0,t.jsx)("div",{className:"flex min-h-screen w-full flex-col items-center justify-center bg-background p-4",children:(0,t.jsxs)("div",{className:"flex flex-col items-center gap-4 text-center",children:[(0,t.jsx)(l.default,{src:"/logorepon.png",alt:"Logo de RePon",width:180,height:45,priority:!0}),(0,t.jsx)(n.A,{className:"h-8 w-8 animate-spin text-muted-foreground"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Verificando autenticaci\xf3n..."})]})}):(0,t.jsx)(o.Provider,{value:{user:s,loading:c},children:a})}let c=()=>{let e=(0,r.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},5813:(e,a,s)=>{"use strict";let t,r,i;s.d(a,{db:()=>i,j:()=>r});var n=s(3915),l=s(3004),o=s(5317);t=0===(0,n.Dk)().length?(0,n.Wp)({apiKey:"AIzaSyA6602Gif2lyUqh6Ix1cUK-GAzwNJ-VU1g",authDomain:"localhost",projectId:"apprepon",storageBucket:"apprepon.appspot.com",messagingSenderId:"165040282600",appId:"1:165040282600:web:3869fbbfee23f559fce25d"}):(0,n.Sx)(),i=(0,o.aU)(t),r=(0,l.xI)(t),window.__firebase_persistence_enabled||(window.__firebase_persistence_enabled=!0,(0,o.ol)(i).catch(e=>{"failed-precondition"==e.code?console.warn("Firebase persistence failed: Multiple tabs open. Persistence can only be enabled in one tab at a time."):"unimplemented"==e.code?console.warn("Firebase persistence failed: The current browser does not support all of the features required to enable persistence."):console.error("Firebase persistence error",e)})),window.__FIREBASE_APP__=t},6773:(e,a,s)=>{Promise.resolve().then(s.bind(s,7028))},7028:(e,a,s)=>{"use strict";s.d(a,{default:()=>ac});var t=s(5155),r=s(2115),i=s(4477);let n=(0,i.createServerReference)("407e06e47482fa3e6ebdf56f22c25a54016cd1f5c4",i.callServer,void 0,i.findSourceMapURL,"correctProductNameAction"),l=(0,i.createServerReference)("40e69908f0cd25edae47a6be76c1f205f270ff6358",i.callServer,void 0,i.findSourceMapURL,"generateGrammaticalMessageAction"),o=(0,i.createServerReference)("40ede8de819761e4229c5127d3b6871051dddbb5c5",i.callServer,void 0,i.findSourceMapURL,"generateRecipeAction");var d=s(7481);function c(){return{toast:(0,r.useCallback)(e=>{let{audioText:a,...s}=e,t=(0,d.oR)(s);return{id:t.id,dismiss:t.dismiss,update:e=>t.update({...e,id:t.id})}},[])}}var u=s(5317),m=s(5813),p=s(9737);let h=e=>{if(!Array.isArray(e))return[];let a=new Set,s=[];for(let l of e){var t,r,i,n;if(l&&"object"==typeof l&&null!=l.id)!a.has(l.id)&&l.name&&l.category&&l.status&&(a.add(l.id),s.push({id:l.id,name:l.name,category:l.category,status:l.status,isPendingPurchase:null!=(t=l.isPendingPurchase)&&t,buyLater:null!=(r=l.buyLater)&&r,...l.reason?{reason:l.reason}:{}}));else if(l&&"object"==typeof l&&null==l.id){let e=(0,p.A)();a.has(e)||(a.add(e),s.push({id:e,name:l.name||"Producto sin nombre",category:l.category||"Otros",status:l.status||"available",isPendingPurchase:null!=(i=l.isPendingPurchase)&&i,buyLater:null!=(n=l.buyLater)&&n,...l.reason?{reason:l.reason}:{}}))}}return s};async function x(e,a){if(!m.db)return void console.warn("Firebase is not initialized. Update operation skipped.");let s=(0,u.H9)(m.db,"lists",e);try{let e={};a.pantry&&(e.pantry=h(a.pantry)),a.shoppingList&&(e.shoppingList=h(a.shoppingList)),a.history&&(e.history=a.history),await (0,u.BN)(s,e,{merge:!0})}catch(e){throw console.error("Error updating list:",e),e}}let f=(0,i.createServerReference)("4096c61bada955d8d04f57047c6b8d35648baa1c91",i.callServer,void 0,i.findSourceMapURL,"categorizeProductAction");var g=s(5821),j=s(5318),v=s(9434);let y=g.bL;g.l9;let b=g.ZL;g.bm;let N=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(g.hJ,{ref:a,className:(0,v.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r})});N.displayName=g.hJ.displayName;let w=r.forwardRef((e,a)=>{let{className:s,children:r,...i}=e;return(0,t.jsxs)(b,{children:[(0,t.jsx)(N,{}),(0,t.jsxs)(g.UC,{ref:a,className:(0,v.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...i,children:[r,(0,t.jsxs)(g.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,t.jsx)(j.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});w.displayName=g.UC.displayName;let C=e=>{let{className:a,...s}=e;return(0,t.jsx)("div",{className:(0,v.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),...s})};C.displayName="DialogHeader";let k=e=>{let{className:a,...s}=e;return(0,t.jsx)("div",{className:(0,v.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...s})};k.displayName="DialogFooter";let A=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(g.hE,{ref:a,className:(0,v.cn)("text-lg font-semibold leading-none tracking-tight",s),...r})});A.displayName=g.hE.displayName;let L=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(g.VY,{ref:a,className:(0,v.cn)("text-sm text-muted-foreground",s),...r})});L.displayName=g.VY.displayName;var S=s(285);let P=(0,i.createServerReference)("40af9af4b326fdc12db22a9381fa2c0e8a5aab80df",i.callServer,void 0,i.findSourceMapURL,"identifyProductsFromPhotoAction");var E=s(1949),R=s(172),z=s(7933),T=s(6923),I=s(7554),_=s(518),D=s(6981);let M=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(D.bL,{ref:a,className:(0,v.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...r,children:(0,t.jsx)(D.C1,{className:(0,v.cn)("flex items-center justify-center text-current"),children:(0,t.jsx)(_.A,{className:"h-4 w-4"})})})});M.displayName=D.bL.displayName;var O=s(968);let F=(0,s(2085).F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),U=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(O.b,{ref:a,className:(0,v.cn)(F(),s),...r})});function $(e){let{open:a,onOpenChange:s,onAddProducts:i}=e,{toast:n}=c(),l=(0,r.useRef)(null),o=(0,r.useRef)(null),d=(0,r.useRef)(null),u=(0,r.useRef)(null),[m,p]=(0,r.useState)("capture"),[h,x]=(0,r.useState)(null),[f,g]=(0,r.useState)([]),[j,v]=(0,r.useState)(new Set),b=(0,r.useCallback)(()=>{u.current&&(u.current.getTracks().forEach(e=>e.stop()),u.current=null),l.current&&(l.current.srcObject=null)},[]),N=()=>{p("capture"),g([]),v(new Set),null===h&&D()},D=async()=>{var e;if("function"!=typeof(null==(e=navigator.mediaDevices)?void 0:e.getUserMedia))return void x(!1);try{let e=await navigator.mediaDevices.getUserMedia({video:{facingMode:{exact:"environment"}}});u.current=e,x(!0),l.current&&(l.current.srcObject=e)}catch(e){console.error("Error accessing rear camera",e);try{let e=await navigator.mediaDevices.getUserMedia({video:!0});u.current=e,x(!0),l.current&&(l.current.srcObject=e)}catch(e){console.error("Error accessing camera",e),x(!1)}}};(0,r.useEffect)(()=>(a?N():b(),()=>{b()}),[a,b]);let O=async e=>{p("processing");try{let a=await P({photoDataUri:e});a.products.length>0?(g(a.products),v(new Set(a.products)),p("confirm")):(n({title:"No se encontraron productos",description:"Prueba con otra foto m\xe1s clara o con m\xe1s productos.",variant:"destructive"}),p("capture"))}catch(e){console.error("Identification failed",e),n({title:"Error en la identificaci\xf3n",description:"No se pudieron identificar los productos.",variant:"destructive"}),p("capture")}},F=(e,a)=>{v(s=>{let t=new Set(s);return a?t.add(e):t.delete(e),t})};return(0,t.jsx)(y,{open:a,onOpenChange:s,children:(0,t.jsxs)(w,{className:"sm:max-w-md",children:[(0,t.jsxs)(C,{children:[(0,t.jsx)(A,{children:"A\xf1adir desde foto"}),(0,t.jsxs)(L,{children:["capture"===m&&"Usa tu c\xe1mara o sube una foto de tus productos.","processing"===m&&"Identificando productos en la imagen...","confirm"===m&&"Confirma los productos a a\xf1adir a tu despensa."]})]}),"capture"===m&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"relative aspect-video w-full overflow-hidden rounded-md bg-muted border",children:[(0,t.jsx)("video",{ref:l,className:"w-full h-full object-cover",autoPlay:!0,muted:!0,playsInline:!0}),(0,t.jsx)("canvas",{ref:o,className:"hidden"}),!1===h&&(0,t.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-center p-4",children:[(0,t.jsx)(E.A,{className:"h-8 w-8 text-destructive mb-2"}),(0,t.jsx)("p",{className:"font-semibold",children:"C\xe1mara no disponible"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Por favor, permite el acceso a la c\xe1mara en tu navegador para usar esta funci\xf3n."})]}),null===h&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,t.jsx)(R.A,{className:"h-8 w-8 animate-spin text-muted-foreground"})})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(S.$,{onClick:()=>{if(l.current&&o.current){let e=l.current,a=o.current;a.width=e.videoWidth,a.height=e.videoHeight;let s=a.getContext("2d");s&&(s.drawImage(e,0,0,a.width,a.height),O(a.toDataURL("image/jpeg")))}},disabled:!h,className:"w-full",children:[(0,t.jsx)(z.A,{className:"mr-2"})," Tomar Foto"]}),(0,t.jsxs)(S.$,{variant:"outline",onClick:()=>{var e;return null==(e=d.current)?void 0:e.click()},className:"w-full",children:[(0,t.jsx)(T.A,{className:"mr-2"})," Subir Imagen"]}),(0,t.jsx)("input",{type:"file",ref:d,onChange:e=>{var a;let s=null==(a=e.target.files)?void 0:a[0];if(s){let e=new FileReader;e.onloadend=()=>{O(e.result)},e.readAsDataURL(s)}},accept:"image/*",className:"hidden"})]})]}),"processing"===m&&(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4 py-8",children:[(0,t.jsx)(R.A,{className:"h-12 w-12 animate-spin text-primary"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Analizando tu foto..."})]}),"confirm"===m&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{className:"max-h-60 space-y-2 overflow-y-auto rounded-md border p-4",children:f.map((e,a)=>{let s="identified-product-".concat(e,"-").concat(a);return(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(M,{id:s,checked:j.has(e),onCheckedChange:a=>F(e,!!a)}),(0,t.jsx)(U,{htmlFor:s,className:"cursor-pointer font-normal",children:e})]},s)})}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:[j.size," de ",f.length," seleccionados"]}),(0,t.jsxs)(S.$,{variant:"ghost",size:"sm",onClick:N,children:[(0,t.jsx)(I.A,{className:"mr-2 h-4 w-4"}),"Probar de nuevo"]})]})]}),(0,t.jsx)(k,{className:"mt-4",children:"confirm"===m&&(0,t.jsxs)(S.$,{onClick:()=>{i(Array.from(j)),s(!1)},disabled:0===j.size,className:"w-full",children:[(0,t.jsx)(_.A,{className:"mr-2"})," A\xf1adir ",j.size," productos"]})})]})})}U.displayName=O.b.displayName;var V=s(5599);function B(e){let{open:a,onOpenChange:s,pantry:i,shoppingList:n}=e,{toast:l}=c(),[o,d]=(0,r.useState)(new Set(["pantry","shoppingList"])),u=(e,a)=>{d(s=>{let t=new Set(s);return a?t.add(e):t.delete(e),t})},m=()=>{let e="";if(o.has("pantry")&&i.length>0&&(e+="*Mi Despensa:*\n".concat(i.map(e=>"- ".concat(e.name," (").concat(e.status,")")).join("\n"),"\n\n")),o.has("shoppingList")&&n.length>0){let a=n.filter(e=>!e.buyLater),s=n.filter(e=>e.buyLater);a.length>0&&(e+="*Lista de Compra:*\n".concat(a.map(e=>"- ".concat(e.name)).join("\n"),"\n\n")),s.length>0&&(e+="*Comprar otro d\xeda:*\n".concat(s.map(e=>"- ".concat(e.name)).join("\n"),"\n\n"))}return e.trim()},p=e=>{if(!e)return void l({title:"Nada que copiar",description:"Selecciona al menos una lista con productos.",variant:"destructive",duration:3e3});navigator.clipboard.writeText(e).then(()=>{l({title:"Contenido copiado al portapapeles",duration:2500}),s(!1)},()=>{l({title:"Error al copiar el contenido",variant:"destructive"})})};return(0,t.jsx)(y,{open:a,onOpenChange:s,children:(0,t.jsxs)(w,{children:[(0,t.jsxs)(C,{children:[(0,t.jsx)(A,{children:"Compartir lista"}),(0,t.jsx)(L,{children:"Elige qu\xe9 listas quieres incluir y c\xf3mo quieres compartirlas."})]}),(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(M,{id:"share-pantry",checked:o.has("pantry"),onCheckedChange:e=>u("pantry",!!e)}),(0,t.jsxs)(U,{htmlFor:"share-pantry",className:"cursor-pointer",children:["Despensa (",i.length,")"]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(M,{id:"share-shoppingList",checked:o.has("shoppingList"),onCheckedChange:e=>u("shoppingList",!!e)}),(0,t.jsxs)(U,{htmlFor:"share-shoppingList",className:"cursor-pointer",children:["Lista de Compra (",n.length,")"]})]})]}),(0,t.jsx)(k,{className:"sm:justify-end gap-2",children:(0,t.jsxs)(S.$,{variant:"outline",onClick:()=>p(m()),children:[(0,t.jsx)(V.A,{className:"mr-2 h-4 w-4"})," Copiar al portapapeles"]})})]})})}var q=s(6766),H=s(5544),G=s(5695),Z=s(4430),J=s(5977);let Y=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(J.bL,{ref:a,className:(0,v.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...r})});Y.displayName=J.bL.displayName;let K=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(J._V,{ref:a,className:(0,v.cn)("aspect-square h-full w-full",s),...r})});K.displayName=J._V.displayName;let Q=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(J.H4,{ref:a,className:(0,v.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...r})});Q.displayName=J.H4.displayName;var W=s(5853),X=s(8239),ee=s(4928),ea=s(1433),es=s(2400),et=s(9800),er=s(7212),ei=s(7657),en=s(5064),el=s(7374),eo=s(8046),ed=s(4815),ec=s(8350),eu=s(5943),em=s(4675),ep=s(7223),eh=s(3759),ex=s(3638),ef=s(5675),eg=s(8330),ej=s(2303),ev=s(6655),ey=s(4214),eb=s(9798),eN=s(4437),ew=s(7270),eC=s(6318),ek=s(7390),eA=s(1721),eL=s(3349),eS=s(5074),eP=s(8271),eE=s(9572);let eR=r.forwardRef((e,a)=>{let{className:s,type:r,...i}=e;return(0,t.jsx)("input",{type:r,className:(0,v.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:a,...i})});eR.displayName="Input";var ez=s(4884);let eT=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(ez.bL,{className:(0,v.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-[#5D6D7E]/40 data-[state=checked]:border-transparent data-[state=unchecked]:border-gray-400",s),...r,ref:a,children:(0,t.jsx)(ez.zi,{className:(0,v.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});eT.displayName=ez.bL.displayName;var eI=s(6215),e_=s(3158),eD=s(154);let eM=eI.bL,eO=eI.l9;eI.YJ;let eF=eI.ZL,eU=eI.Pb,e$=eI.z6,eV=r.forwardRef((e,a)=>{let{className:s,inset:r,children:i,...n}=e;return(0,t.jsxs)(eI.ZP,{ref:a,className:(0,v.cn)("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",s),...n,children:[i,(0,t.jsx)(e_.A,{className:"ml-auto"})]})});eV.displayName=eI.ZP.displayName;let eB=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(eI.G5,{ref:a,className:(0,v.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...r})});eB.displayName=eI.G5.displayName;let eq=r.forwardRef((e,a)=>{let{className:s,sideOffset:r=4,...i}=e;return(0,t.jsx)(eI.ZL,{children:(0,t.jsx)(eI.UC,{ref:a,sideOffset:r,className:(0,v.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...i})})});eq.displayName=eI.UC.displayName;let eH=r.forwardRef((e,a)=>{let{className:s,inset:r,...i}=e;return(0,t.jsx)(eI.q7,{ref:a,className:(0,v.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",s),...i})});eH.displayName=eI.q7.displayName,r.forwardRef((e,a)=>{let{className:s,children:r,checked:i,...n}=e;return(0,t.jsxs)(eI.H_,{ref:a,className:(0,v.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:i,...n,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(eI.VF,{children:(0,t.jsx)(_.A,{className:"h-4 w-4"})})}),r]})}).displayName=eI.H_.displayName;let eG=r.forwardRef((e,a)=>{let{className:s,children:r,...i}=e;return(0,t.jsxs)(eI.hN,{ref:a,className:(0,v.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...i,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(eI.VF,{children:(0,t.jsx)(eD.A,{className:"h-2 w-2 fill-current"})})}),r]})});eG.displayName=eI.hN.displayName;let eZ=r.forwardRef((e,a)=>{let{className:s,inset:r,...i}=e;return(0,t.jsx)(eI.JU,{ref:a,className:(0,v.cn)("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",s),...i})});eZ.displayName=eI.JU.displayName;let eJ=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(eI.wv,{ref:a,className:(0,v.cn)("-mx-1 my-1 h-px bg-muted",s),...r})});eJ.displayName=eI.wv.displayName;var eY=s(704);let eK=eY.bL,eQ=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(eY.B8,{ref:a,className:(0,v.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...r})});eQ.displayName=eY.B8.displayName;let eW=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(eY.l9,{ref:a,className:(0,v.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border-b-2 border-transparent text-muted-foreground data-[state=active]:bg-primary/50 data-[state=active]:font-bold data-[state=active]:text-verde-eucalipto data-[state=active]:border-b-4 data-[state=active]:border-[#4DA6FF]",s),...r})});eW.displayName=eY.l9.displayName;let eX=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(eY.UC,{ref:a,className:(0,v.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...r})});eX.displayName=eY.UC.displayName;var e0=s(1978),e2=s(760),e4=s(8082);let e1=e4.Kq,e5=e4.bL,e8=e4.l9,e3=r.forwardRef((e,a)=>{let{className:s,sideOffset:r=4,...i}=e;return(0,t.jsx)(e4.UC,{ref:a,sideOffset:r,className:(0,v.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...i})});e3.displayName=e4.UC.displayName;var e9=s(7250),e6=s(9556);let e7=e9.bL,ae=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(e9.q7,{ref:a,className:(0,v.cn)("border-b",s),...r})});ae.displayName="AccordionItem";let aa=r.forwardRef((e,a)=>{let{className:s,children:r,...i}=e;return(0,t.jsx)(e9.Y9,{className:"flex",children:(0,t.jsxs)(e9.l9,{ref:a,className:(0,v.cn)("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",s),...i,children:[r,(0,t.jsx)(e6.A,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})})});aa.displayName=e9.l9.displayName;let as=r.forwardRef((e,a)=>{let{className:s,children:r,...i}=e;return(0,t.jsx)(e9.UC,{ref:a,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...i,children:(0,t.jsx)("div",{className:(0,v.cn)("pb-4 pt-0",s),children:r})})});as.displayName=e9.UC.displayName;var at=s(7489);let ar=r.forwardRef((e,a)=>{let{className:s,orientation:r="horizontal",decorative:i=!0,...n}=e;return(0,t.jsx)(at.b,{ref:a,decorative:i,orientation:r,className:(0,v.cn)("shrink-0 bg-border","horizontal"===r?"h-[1px] w-full":"h-full w-[1px]",s),...n})});ar.displayName=at.b.displayName;let ai=["Frutas y Verduras","L\xe1cteos y Huevos","Prote\xednas","Panader\xeda y Cereales","Aperitivos","Bebidas","Hogar y Limpieza","Condimentos y Especias","Conservas y Despensa","Otros"],an={"Frutas y Verduras":(0,t.jsx)(W.A,{className:"h-4 w-4"}),"L\xe1cteos y Huevos":(0,t.jsx)(X.A,{className:"h-4 w-4"}),ProteÃ­nas:(0,t.jsx)(ee.A,{className:"h-4 w-4"}),"Panader\xeda y Cereales":(0,t.jsx)(ea.A,{className:"h-4 w-4"}),Aperitivos:(0,t.jsx)(es.A,{className:"h-4 w-4"}),Bebidas:(0,t.jsx)(et.A,{className:"h-4 w-4"}),"Hogar y Limpieza":(0,t.jsx)(er.A,{className:"h-4 w-4"}),"Condimentos y Especias":(0,t.jsx)(ei.A,{className:"h-4 w-4"}),"Conservas y Despensa":(0,t.jsx)(en.A,{className:"h-4 w-4"}),Otros:(0,t.jsx)(el.A,{className:"h-4 w-4"})};function al(e){let{onAddItem:a,history:s,pantry:i,shoppingList:n,activeTab:l}=e,[o,d]=(0,r.useState)(""),[c,u]=(0,r.useState)([]),m=(0,r.useRef)(null);(0,r.useEffect)(()=>{d(""),u([])},[l]);let p=e=>{a(e),d(""),u([])};return(0,t.jsx)("div",{className:"relative pt-4",children:(0,t.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),o.trim()){var s;a(o.trim()),d(""),u([]),null==(s=m.current)||s.focus()}},className:"flex gap-2",children:[(0,t.jsxs)("div",{className:"relative flex-grow",children:[(0,t.jsx)(eR,{ref:m,type:"text",value:o,onChange:e=>{let a=e.target.value;if(d(a),a&&!a.includes(",")){let e=new Set(("pantry"===l?i:n).map(e=>e.name.toLowerCase()));u(s.filter(s=>s.toLowerCase().includes(a.toLowerCase())&&!e.has(s.toLowerCase())).slice(0,5))}else u([])},placeholder:"Puedes a\xf1adir varios productos separados por comas",className:"flex-grow bg-gray-800 text-white placeholder-gray-400"}),c.length>0&&(0,t.jsx)(e0.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"absolute z-10 w-full bg-background border rounded-md shadow-lg mt-1 p-2 flex flex-col gap-1",children:c.map((e,a)=>(0,t.jsx)("button",{type:"button",onClick:()=>p(e),className:"text-left p-2 rounded hover:bg-accent w-full",children:e},"suggestion-".concat(e,"-").concat(a)))})]}),(0,t.jsx)(S.$,{type:"submit",size:"icon","aria-label":"A\xf1adir producto",className:"hover:opacity-80",children:(0,t.jsx)(eo.A,{})})]})})}function ao(e){let{product:a,viewMode:s,isPulsing:r,isExiting:i,onUpdateStatus:n,onDelete:l,onAddToShoppingList:o,onUpdateCategory:d,onEdit:c}=e,u={available:"bg-verde-eucalipto text-white",low:"bg-amarillo-mostaza text-white","out of stock":"bg-rojo-coral text-white"}[a.status],m="list"===s;return(0,t.jsxs)(e0.P.div,{id:"product-".concat(a.id),layout:!0,layoutId:"pantry-"+a.id,initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,x:i?100:50,transition:{duration:.3}},transition:{type:"spring",stiffness:300,damping:30},className:(0,v.cn)("rounded-md transition-all duration-300 hover:brightness-110 shadow-md mb-2 p-3",m?"flex items-center justify-between":"flex flex-col gap-2",u,"cursor-pointer transition-colors transition-color",r&&"pulse bg-amarillo-mostaza"),onClick:()=>{let e=["available","low","out of stock"],s=e.indexOf(a.status),t=e[(s+1)%e.length];n(a.id,t)},children:[(0,t.jsx)("div",{className:(0,v.cn)("flex items-center flex-grow gap-3",m?"":"flex-col gap-2"),children:(0,t.jsx)("h3",{className:(0,v.cn)("font-semibold",m?"":"text-center"),children:a.name})}),(0,t.jsxs)("div",{className:(0,v.cn)("shrink-0",m?"flex items-center gap-1":"flex flex-wrap justify-center gap-1 mt-2"),children:["low"===a.status&&(a.isPendingPurchase?(0,t.jsx)("div",{className:"flex items-center justify-center text-xs h-8 px-2 rounded-md bg-[#5D6D7E] text-white border border-[#5D6D7E] font-medium",children:"Pendiente de compra"}):(0,t.jsx)(e1,{children:(0,t.jsxs)(e5,{children:[(0,t.jsx)(e8,{asChild:!0,children:(0,t.jsx)(S.$,{variant:"secondary",size:"icon",className:"h-8 w-8 bg-gray-800 text-white hover:bg-gray-700","aria-label":"A\xf1adir a la lista de compra",onClick:e=>{e.stopPropagation(),o(a.id)},children:(0,t.jsx)(ed.A,{className:"h-4 w-4"})})}),(0,t.jsx)(e3,{children:(0,t.jsx)("p",{children:"A\xf1adir a la compra"})})]})})),(0,t.jsxs)(eM,{children:[(0,t.jsx)(eO,{asChild:!0,children:(0,t.jsx)(S.$,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:e=>e.stopPropagation(),children:(0,t.jsx)(ec.A,{className:"h-4 w-4"})})}),(0,t.jsxs)(eq,{onClick:e=>e.stopPropagation(),align:"end",children:[(0,t.jsxs)(eH,{onClick:e=>{e.stopPropagation(),c(a)},children:[(0,t.jsx)(eu.A,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{children:"Editar Nombre"})]}),(0,t.jsxs)(eU,{children:[(0,t.jsxs)(eV,{children:[(0,t.jsx)(em.A,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{children:"Cambiar Categor\xeda"})]}),(0,t.jsx)(eF,{children:(0,t.jsx)(eB,{children:(0,t.jsx)(e$,{value:a.category,onValueChange:e=>d(a.id,e),children:ai.map(e=>(0,t.jsx)(eG,{value:e,children:e},e))})})})]}),(0,t.jsx)(eJ,{}),(0,t.jsxs)(eH,{className:"text-[#FF4C4C] hover:bg-[#2C0000] hover:text-white focus:bg-[#2C0000] focus:text-white",onClick:e=>{e.stopPropagation(),l(a.id)},children:[(0,t.jsx)(ep.A,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{children:"Eliminar"})]})]})]})]})]})}function ad(e){let{item:a,viewMode:s,onCardClick:r,onToggleBuyLater:i,onDelete:n,onReturnToPantry:l,onEdit:o,layoutId:d,isChecking:c=!1,isSliding:u=!1}=e,m={available:"bg-verde-eucalipto text-white",low:"bg-amarillo-mostaza text-white","out of stock":"bg-rojo-coral text-white"}[a.status],p="list"===s;return(0,t.jsxs)(e0.P.div,{id:"product-".concat(a.id),layout:!0,layoutId:d,initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,x:u?-100:-50,transition:{duration:.3}},transition:{type:"spring",stiffness:300,damping:30},className:(0,v.cn)("rounded-md transition-all duration-300 hover:brightness-110 shadow-md mb-2 p-3",p?"flex items-center justify-between":"flex flex-col gap-2",m,"transition-colors transition-color",c&&"bg-verde-eucalipto opacity-80"),onClick:()=>r(a.id),children:[(0,t.jsx)("h3",{className:(0,v.cn)("font-semibold flex-grow",p?"":"text-center"),children:a.name}),(0,t.jsxs)("div",{className:(0,v.cn)("shrink-0",p?"flex items-center gap-1":"flex justify-center gap-2 mt-2"),children:[(0,t.jsx)(e1,{children:(0,t.jsxs)(e5,{children:[(0,t.jsx)(e8,{asChild:!0,children:(0,t.jsx)(S.$,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:e=>{e.stopPropagation(),i(a.id)},children:a.buyLater?(0,t.jsx)(eh.A,{className:"h-4 w-4"}):(0,t.jsx)(ex.A,{className:"h-4 w-4"})})}),(0,t.jsx)(e3,{children:(0,t.jsx)("p",{children:a.buyLater?"Mover a la compra de hoy":"Dejar para otro d\xeda"})})]})}),(0,t.jsxs)(eM,{children:[(0,t.jsx)(eO,{asChild:!0,children:(0,t.jsx)(S.$,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:e=>e.stopPropagation(),children:(0,t.jsx)(ec.A,{className:"h-4 w-4"})})}),(0,t.jsxs)(eq,{onClick:e=>e.stopPropagation(),align:"end",children:[(0,t.jsxs)(eH,{onClick:()=>o(a),children:[(0,t.jsx)(eu.A,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{children:"Editar Nombre"})]}),"low"===a.status&&(0,t.jsxs)(eH,{onClick:()=>l(a.id),children:[(0,t.jsx)(ef.A,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{children:"Devolver a despensa"})]}),(0,t.jsx)(eJ,{}),(0,t.jsxs)(eH,{className:"text-[#FF4C4C] hover:bg-[#2C0000] hover:text-white focus:bg-[#2C0000] focus:text-white",onClick:()=>n(a.id),children:[(0,t.jsx)(ep.A,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{children:"Eliminar"})]})]})]})]})]})}function ac(e){var a,s;let{listId:i}=e,{user:d,loading:g}=(0,H.A)(),b=(0,G.useRouter)(),[N,P]=(0,r.useState)("pantry"),{toast:T}=c(),{pantry:_,shoppingList:D,history:M,isLoaded:O,hasPendingWrites:F,handleAddItem:V,handleBulkAdd:J,updateRemoteList:W,handleShoppingListAddItem:X}=function(e,a){let s=null!=e?e:"nuestra-despensa-compartida",[t,i]=(0,r.useState)({pantry:[],shoppingList:[],history:[]}),[l,o]=(0,r.useState)(!1),[d,c]=(0,r.useState)(!1);(0,r.useEffect)(()=>{if(!m.db)return void o(!0);o(!1);let e=(0,u.H9)(m.db,"lists",s),t=!0,r=(0,u.aQ)(e,s=>{if(c(s.metadata.hasPendingWrites),!s.exists()&&t)(0,u.BN)(e,{pantry:[],shoppingList:[],history:[]}).catch(e=>{console.error("Failed to create list document:",e),a({title:"Error de Creaci\xf3n",description:"No se pudo crear la lista compartida.",variant:"destructive"})});else if(s.exists()){let e=s.data();i({pantry:h(e.pantry),shoppingList:h(e.shoppingList),history:Array.isArray(e.history)?e.history:[]})}t&&(o(!0),t=!1)},e=>{console.error("Failed to subscribe to list data:",e),a({title:"Error de Conexi\xf3n",description:"No se pudieron cargar los datos. Revisa tu conexi\xf3n a internet.",variant:"destructive"}),o(!0)});return()=>r()},[s,a]);let g=(0,r.useCallback)(e=>{if(!m.db)return void a({title:"Error de Conexi\xf3n",description:"No se puede conectar a la base de datos. Los cambios no se guardar\xe1n.",variant:"destructive",duration:5e3});x(s,e).catch(e=>{console.error("Failed to update list:",e),a({title:"Error de Sincronizaci\xf3n",description:"No se pudieron guardar los cambios.",variant:"destructive"})})},[s,a]),j=(0,r.useCallback)(async e=>{if(m.db&&0!==e.length)try{let a=new Set(t.pantry.map(e=>e.name.toLowerCase())),s=new Map(t.shoppingList.map(e=>[e.name.toLowerCase(),e])),r=[],i=[],l=new Map;for(let a of e){let{correctedName:e}=await n({productName:a});l.set(a,e)}for(let e of[...new Set(l.values())]){let t=e.toLowerCase();a.has(t)?alert('"'.concat(e,'" ya est\xe1 en tu despensa.')):s.has(t)?alert('"'.concat(e,'" ya est\xe1 en la lista de la compra.')):i.push(e)}let o=[...await Promise.all(i.map(async e=>{let{category:a}=await f({productName:e});return{id:(0,p.A)(),name:e,category:a,status:"available",isPendingPurchase:!1,buyLater:!1}})),...r.map(e=>{let{reason:a,...s}=e;return{...s,status:"available",isPendingPurchase:!1,buyLater:!1}})];if(o.length>0){let e=t.shoppingList.filter(e=>!r.some(a=>a.name.toLowerCase()===e.name.toLowerCase())),a=[...t.pantry,...o],s=[...new Set([...t.history,...o.map(e=>e.name)])];g({pantry:a,shoppingList:e,history:s})}}catch(e){console.error("Failed to add item(s):",e),alert("Error al guardar los productos")}},[t.pantry,t.shoppingList,t.history,a,g,m.db]),v=(0,r.useCallback)(e=>{let a=e.split(",").map(e=>e.trim()).filter(Boolean);a.length>0&&j(a)},[j]),y=(0,r.useCallback)(async e=>{if(m.db&&0!==e.length)try{let a=new Set(t.pantry.map(e=>e.name.toLowerCase())),s=new Set(t.shoppingList.map(e=>e.name.toLowerCase())),r=[],i=await Promise.all(e.map(e=>n({productName:e})));for(let e of[...new Map(i.map(e=>[e.correctedName.toLowerCase(),e.correctedName])).values()]){let t=e.toLowerCase();a.has(t)?alert('"'.concat(e,'" ya est\xe1 en tu despensa.')):s.has(t)?alert('"'.concat(e,'" ya est\xe1 en la lista de la compra.')):r.push({name:e})}if(0===r.length)return;let l=await Promise.all(r.map(async e=>{let{category:a}=await f({productName:e.name});return{id:(0,p.A)(),name:e.name,category:a,status:"out of stock",reason:"out of stock",isPendingPurchase:!1,buyLater:!1}})),o=[...t.shoppingList,...l],d=[...new Set([...t.history,...l.map(e=>e.name)])];g({shoppingList:o,history:d})}catch(e){console.error("Failed to add item(s) to shopping list:",e),alert("Error al guardar la lista de compra")}},[t.pantry,t.shoppingList,t.history,a,g,m.db]),b=(0,r.useCallback)(async e=>{let a=e.split(",").map(e=>e.trim()).filter(Boolean);a.length>0&&await y(a)},[y]);return{...t,isLoaded:l,hasPendingWrites:d,handleAddItem:v,handleBulkAdd:j,updateRemoteList:g,handleShoppingListAddItem:b}}(i,T),[ee,ea]=(0,r.useState)("list"),[es,et]=(0,r.useState)(!1),[er,ei]=(0,r.useState)({by:"name",order:"asc"}),[en,el]=(0,r.useState)("all"),[eo,ed]=(0,r.useState)(null),[ec,eu]=(0,r.useState)(""),[eh,ex]=(0,r.useState)(!1),[ef,ez]=(0,r.useState)(!1),[eI,e_]=(0,r.useState)(!1),[eD,eF]=(0,r.useState)(!1),[eU,eV]=(0,r.useState)(null),[eB,eY]=(0,r.useState)(null),[e4,e9]=(0,r.useState)(null),[e6,at]=(0,r.useState)(null),[ai,ac]=(0,r.useState)(!1),[au,am]=(0,r.useState)(null),[ap,ah]=(0,r.useState)(!1),[ax,af]=(0,r.useState)([]),[ag,aj]=(0,r.useState)(["buy-later-section"]),av=(0,r.useRef)([]),ay=(0,r.useRef)([]),[ab,aN]=(0,r.useState)(null),[aw,aC]=(0,r.useState)("");(0,r.useEffect)(()=>{ab&&aC(ab.name)},[ab]);let ak=async()=>{if(!ab||!aw.trim())return void aN(null);let e=aw.trim();if(e.toLowerCase()===ab.name.toLowerCase())return void aN(null);let a=T({title:"Actualizando nombre...",duration:5e3});try{let{correctedName:s}=await n({productName:e}),t=ab.name,r=_.some(e=>e.id===ab.id),i=D.some(e=>e.id===ab.id),l=r&&_.some(e=>e.name.toLowerCase()===s.toLowerCase()&&e.id!==ab.id),o=i&&D.some(e=>e.name.toLowerCase()===s.toLowerCase()&&e.id!==ab.id);if(l||o)return void a.update({title:"Error: Producto duplicado",description:'Ya existe un producto llamado "'.concat(s,'".'),variant:"destructive"});let d=_.map(e=>e.id===ab.id?{...e,name:s}:e),c=D.map(e=>e.id===ab.id?{...e,name:s}:e),u=[...new Set([...M.filter(e=>e.toLowerCase()!==t.toLowerCase()),s])];W({pantry:d,shoppingList:c,history:u}),a.update({title:"\xa1Nombre actualizado!",description:'"'.concat(t,'" ahora es "').concat(s,'".')})}catch(e){console.error("Error updating product name:",e),a.update({title:"Error",description:"No se pudo actualizar el nombre del producto.",variant:"destructive"})}finally{aN(null)}},aA={pantry:[{value:"all",label:"Todos"},{value:"available",label:"Disponibles"},{value:"low",label:"Queda poco"}],"shopping-list":[{value:"all",label:"Todos"},{value:"out of stock",label:"Agotados"},{value:"low",label:"Poco stock"}]};(0,r.useEffect)(()=>{g||d||b.replace("/")},[d,g,b]),(0,r.useEffect)(()=>{var e;((null==(e=aA[N])?void 0:e.map(e=>e.value))||[]).includes(en)||el("all")},[N,en,aA]),(0,r.useEffect)(()=>{if(i)try{localStorage.setItem("repon-lastListId",i)}catch(e){console.warn("Could not access localStorage to save list ID.")}},[i]),(0,r.useEffect)(()=>{try{let e=localStorage.getItem("repon-viewMode");e&&["list","grid"].includes(e)&&ea(e)}catch(e){console.warn("Could not access localStorage for viewMode")}},[]),(0,r.useEffect)(()=>{try{localStorage.setItem("repon-viewMode",ee)}catch(e){console.warn("Could not access localStorage for viewMode")}},[ee]);let aL=(0,r.useRef)(!1);(0,r.useEffect)(()=>{"shopping-list"!==N||aL.current||(ea("list"),et(!1),aL.current=!0)},[N]),(0,r.useEffect)(()=>{if(es){let e=new Set(av.current.map(e=>e.id)),a=_.filter(a=>!e.has(a.id));if(a.length>0){let e=new Set(a.map(e=>e.category));af(a=>[...new Set([...a,...Array.from(e)])])}else 0===ax.length&&af([...new Set(_.map(e=>e.category))].filter(e=>void 0!==e))}},[_,es,ax.length]),(0,r.useEffect)(()=>{let e=new Set(av.current.map(e=>e.id)),a=_.filter(a=>!e.has(a.id));if(a.length>0){let e=a[a.length-1].id;setTimeout(()=>{let a=document.getElementById("product-".concat(e));null==a||a.scrollIntoView({behavior:"smooth",block:"center"})},100)}av.current=_},[_]),(0,r.useEffect)(()=>{let e=new Set(ay.current.map(e=>e.id)),a=D.filter(a=>!e.has(a.id));if(a.length>0){let e=a[a.length-1].id;setTimeout(()=>{let a=document.getElementById("product-".concat(e));null==a||a.scrollIntoView({behavior:"smooth",block:"center"})},100)}ay.current=D},[D]),(0,r.useEffect)(()=>{es&&af([...new Set([..._.map(e=>e.category),...D.map(e=>e.category)])].filter(e=>void 0!==e))},[es,_,D]);let aS=async()=>{try{localStorage.removeItem("repon-dev-mode")}catch(e){console.warn("Could not remove dev mode flag from localStorage.")}await (0,Z.CI)(),window.location.href="/"},aP=async(e,a)=>{let s=_.find(a=>a.id===e);if(!s)return;eV(e),setTimeout(()=>eV(null),500);let t=[..._],r=[...D];if("out of stock"===a){W({pantry:_.map(a=>a.id===e?{...a,status:"out of stock"}:a)}),setTimeout(()=>{eY(e),setTimeout(()=>{let a=_.filter(a=>a.id!==e),t=[...D];if(D.find(e=>e.id===s.id))t=D.map(e=>e.id===s.id?{...e,status:"out of stock",reason:"out of stock"}:e);else{let{isPendingPurchase:e,...a}=s;t.push({...a,status:"out of stock",reason:"out of stock",isPendingPurchase:!1,buyLater:!1})}W({pantry:a,shoppingList:t}),eY(null)},500)},2e3);return}if(t=_.map(s=>s.id===e?{...s,status:a,isPendingPurchase:"available"!==a&&s.isPendingPurchase}:s),"available"===a){let e=D.find(e=>e.id===s.id);e&&"low"===e.reason&&(r=D.filter(e=>e.id!==s.id))}W({pantry:t,shoppingList:r})},aE=async(e,a)=>{let s=_.find(a=>a.id===e),t=D.find(a=>a.id===e),r=_,i=D,n="";s&&(n=s.name,r=_.map(s=>s.id===e?{...s,category:a}:s)),t&&(n=t.name,i=D.map(s=>s.id===e?{...s,category:a}:s)),n&&(W({pantry:r,shoppingList:i}),T({title:"\xa1Categor\xeda cambiada!",description:'"'.concat(n,'" ahora est\xe1 en "').concat(a,'".')}))},aR=e=>{let a=D.find(a=>a.id===e),s=_.filter(a=>a.id!==e),t=D.filter(a=>a.id!==e);a&&"low"===a.reason&&(s=s.map(e=>e.name.toLowerCase()===a.name.toLowerCase()?{...e,isPendingPurchase:!1}:e)),W({pantry:s,shoppingList:t}),T({title:"\xa1Adi\xf3s, producto!"}),ed(null)},az=async function(e){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=D.find(a=>a.id===e);if(!s)return;let t=[..._],r=_.findIndex(e=>e.id===s.id);if(r>-1)t[r]={..._[r],status:"available",isPendingPurchase:!1};else{let{reason:e,buyLater:a,...r}=s;t.push({...r,status:"available",isPendingPurchase:!1,buyLater:!1})}if(W({pantry:t,shoppingList:D.filter(a=>a.id!==e)}),!a){let{message:e}=await l({productName:s.name,messageType:"added_to_pantry"});T({title:"\xa1A la saca!",description:e,audioText:e})}},aT=e=>{e9(e),setTimeout(()=>{at(e),setTimeout(()=>{az(e,!0),e9(null),at(null)},500)},1500)},aI=async e=>{let a=_.find(a=>a.id===e);if(!a||"low"!==a.status)return;eV(e),setTimeout(()=>eV(null),500);let s=D.find(e=>e.id===a.id),t=[...D];if(s)t=D.map(e=>e.id===s.id?{...e,buyLater:!1,status:"low",reason:"low"}:e);else{let{isPendingPurchase:e,...s}=a;t.push({...s,status:"low",reason:"low",isPendingPurchase:!1,buyLater:!1})}W({pantry:_.map(a=>a.id===e?{...a,isPendingPurchase:!0}:a),shoppingList:t});let{message:r}=await l({productName:a.name,messageType:"added_to_shopping_list"});T({title:"\xa1Anotado!",description:r,audioText:r})},a_=e=>{D.find(a=>a.id===e)&&W({shoppingList:D.map(a=>a.id===e?{...a,buyLater:!a.buyLater}:a)})},aD=e=>{let a=D.find(a=>a.id===e);a&&"low"===a.status&&(at(e),setTimeout(()=>{W({pantry:_.map(e=>e.id===a.id?{...e,isPendingPurchase:!1}:e),shoppingList:D.filter(a=>a.id!==e)}),at(null)},500))},aM=async()=>{let e=_.filter(e=>"available"===e.status||"low"===e.status).map(e=>e.name);if(0===e.length)return void T({title:"No hay ingredientes",description:"A\xf1ade productos a tu despensa para poder generar una receta.",variant:"destructive"});ah(!0),am(null),ac(!0);try{let a=await o({products:e});am(a)}catch(e){console.error("Error generating recipe",e),T({title:"Error al crear la receta",description:"No se pudo generar una receta en este momento. Int\xe9ntalo de nuevo.",variant:"destructive"}),ac(!1)}finally{ah(!1)}},aO=()=>{ei(e=>"name"===e.by?{by:"name",order:"asc"===e.order?"desc":"asc"}:{by:"name",order:"asc"})},aF=e=>{let{by:a,order:s}=er,t=[...e];return t.sort((e,a)=>{let t=e.name.localeCompare(a.name);return"asc"===s?t:-t}),t.filter(e=>"all"===en||e.status===en).filter(e=>!ec||e.name.toLowerCase().includes(ec.toLowerCase()))},aU=(0,r.useMemo)(()=>aF(_),[_,er,en,ec]),a$=(0,r.useMemo)(()=>aF(D),[D,er,en,ec]),aV=(0,r.useMemo)(()=>a$.filter(e=>!e.buyLater),[a$]),aB=(0,r.useMemo)(()=>a$.filter(e=>e.buyLater),[a$]),aq=(0,r.useMemo)(()=>es?aU.reduce((e,a)=>{let s=a.category||"Otros";return e[s]||(e[s]=[]),e[s].push(a),e},{}):null,[aU,es]),aH=(0,r.useMemo)(()=>aq?Object.keys(aq).sort():[],[aq]),aG=(0,r.useMemo)(()=>es?aV.reduce((e,a)=>{let s=a.category||"Otros";return e[s]||(e[s]=[]),e[s].push(a),e},{}):null,[aV,es]),aZ=(0,r.useMemo)(()=>aG?Object.keys(aG).sort():[],[aG]),aJ=(0,r.useMemo)(()=>es?aB.reduce((e,a)=>{let s=a.category||"Otros";return e[s]||(e[s]=[]),e[s].push(a),e},{}):null,[aB,es]),aY=(0,r.useMemo)(()=>aJ?Object.keys(aJ).sort():[],[aJ]),aK="pantry"===N?V:X,aQ=aA[N]||aA.pantry;if(g||!O||!d)return(0,t.jsx)("div",{className:"flex min-h-screen w-full items-center justify-center bg-background",children:(0,t.jsxs)("div",{className:"flex flex-col items-center gap-4 text-center",children:[(0,t.jsx)(q.default,{src:"/logorepon.png",alt:"Logo de RePon",width:180,height:45,priority:!0}),(0,t.jsx)(R.A,{className:"h-8 w-8 animate-spin text-muted-foreground"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Cargando tu despensa..."})]})});let aW=()=>(0,t.jsxs)(e$,{value:en,onValueChange:e=>el(e),children:[(0,t.jsx)(eZ,{children:"Filtrar por Estado"}),(0,t.jsx)(eJ,{}),aQ.map(e=>(0,t.jsx)(eG,{value:e.value,children:e.label},"filter-opt-".concat(e.value)))]});return(0,t.jsxs)("div",{className:"min-h-screen bg-background text-foreground",children:[(0,t.jsx)("header",{className:"sticky top-0 z-20 w-full border-b bg-background/80 backdrop-blur-sm",children:(0,t.jsxs)("div",{className:"container mx-auto flex h-20 items-center justify-between px-4 sm:px-6 lg:px-8",children:[(0,t.jsx)("div",{className:"flex items-center",children:(0,t.jsx)("span",{className:"font-headline text-3xl font-bold text-primary",children:"RePon"})}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[F&&(0,t.jsx)(e1,{children:(0,t.jsxs)(e5,{children:[(0,t.jsx)(e8,{asChild:!0,children:(0,t.jsx)(eb.A,{className:"h-5 w-5 animate-spin text-amber-500"})}),(0,t.jsx)(e3,{children:(0,t.jsx)("p",{children:"Guardando cambios..."})})]})}),(0,t.jsxs)(e1,{children:[(0,t.jsxs)(e5,{children:[(0,t.jsx)(e8,{asChild:!0,children:(0,t.jsx)(S.$,{variant:"ghost",size:"icon",disabled:0===_.filter(e=>"available"===e.status||"low"===e.status).length,onClick:aM,children:(0,t.jsx)(eN.A,{className:"h-5 w-5"})})}),(0,t.jsx)(e3,{children:(0,t.jsx)("p",{children:"Generar Receta"})})]}),(0,t.jsxs)(e5,{children:[(0,t.jsx)(e8,{asChild:!0,children:(0,t.jsx)(S.$,{variant:"ghost",size:"icon",onClick:()=>eF(!0),children:(0,t.jsx)(ew.A,{className:"h-5 w-5"})})}),(0,t.jsx)(e3,{children:(0,t.jsx)("p",{children:"Ayuda"})})]}),(0,t.jsxs)(e5,{children:[(0,t.jsx)(e8,{asChild:!0,children:(0,t.jsx)(S.$,{variant:"ghost",size:"icon",onClick:()=>{let e=window.location.origin;navigator.clipboard.writeText("".concat(e,"/pantry/nuestra-despensa-compartida")).then(()=>{T({title:"Enlace copiado al portapapeles",duration:2500})},()=>{T({title:"No se pudo copiar el enlace",description:"Esta funci\xf3n podr\xeda no estar disponible en tu navegador. Intenta copiar la URL manualmente.",duration:5e3,variant:"destructive"})})},children:(0,t.jsx)(eC.A,{className:"h-5 w-5"})})}),(0,t.jsx)(e3,{children:(0,t.jsx)("p",{children:"Compartir enlace de la lista"})})]}),(0,t.jsxs)(e5,{children:[(0,t.jsx)(e8,{asChild:!0,children:(0,t.jsx)(S.$,{variant:"ghost",size:"icon",onClick:()=>e_(!0),children:(0,t.jsx)(ek.A,{className:"h-5 w-5"})})}),(0,t.jsx)(e3,{children:(0,t.jsx)("p",{children:"Compartir/Copiar contenido"})})]})]}),(0,t.jsxs)(eM,{children:[(0,t.jsx)(eO,{asChild:!0,children:(0,t.jsx)(S.$,{variant:"ghost",className:"relative h-10 w-10 rounded-full",children:(0,t.jsxs)(Y,{className:"h-9 w-9",children:[(0,t.jsx)(K,{src:d.photoURL||"",alt:d.displayName||"Avatar"}),(0,t.jsx)(Q,{children:d.isAnonymous?(0,t.jsx)(eA.A,{className:"h-5 w-5"}):(null==(a=d.displayName)?void 0:a.charAt(0).toUpperCase())||(null==(s=d.email)?void 0:s.charAt(0).toUpperCase())||"?"})]})})}),(0,t.jsxs)(eq,{className:"w-56",align:"end",forceMount:!0,children:[(0,t.jsx)(eZ,{className:"font-normal",children:(0,t.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,t.jsx)("p",{className:"text-sm font-medium leading-none",children:d.isAnonymous?"Sesi\xf3n de Invitado":d.displayName}),d.email&&(0,t.jsx)("p",{className:"text-xs leading-none text-muted-foreground",children:d.email})]})}),(0,t.jsx)(eJ,{}),(0,t.jsxs)(eH,{onClick:aS,className:d.isAnonymous?"text-red-500 focus:bg-red-500/20":"",children:[d.isAnonymous?(0,t.jsx)(ep.A,{className:"mr-2 h-4 w-4"}):(0,t.jsx)(eL.A,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{children:d.isAnonymous?"Descartar y Salir":"Cerrar sesi\xf3n"})]})]})]})]})]})}),(0,t.jsx)("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-6",children:(0,t.jsxs)(eK,{value:N,onValueChange:e=>P(e),className:"w-full",children:[(0,t.jsxs)("div",{className:"sticky top-20 z-10 bg-background/95 backdrop-blur-sm -mx-4 sm:-mx-6 lg:-mx-8 px-4 sm:px-6 lg:px-8 py-3 border-b mb-6",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[(0,t.jsxs)(eQ,{children:[(0,t.jsx)(eW,{value:"pantry","data-testid":"pantry-tab",children:"Mi Despensa"}),(0,t.jsxs)(eW,{value:"shopping-list","data-testid":"shopping-list-tab",children:["Lista de compra (",D.length,")"]})]}),(0,t.jsxs)("div",{className:"flex sm:hidden w-full items-center justify-between",children:[(0,t.jsx)("div",{className:"flex items-center",children:(0,t.jsx)(e1,{children:(0,t.jsxs)(e5,{children:[(0,t.jsx)(e8,{asChild:!0,children:(0,t.jsx)(S.$,{size:"icon",className:"h-9 w-9",onClick:()=>ez(!0),"aria-label":"A\xf1adir producto con foto",children:(0,t.jsx)(z.A,{className:"h-5 w-5"})})}),(0,t.jsx)(e3,{children:(0,t.jsx)("p",{children:"A\xf1adir producto con foto"})})]})})}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(S.$,{variant:"ghost",size:"icon",className:"h-9 w-9",onClick:()=>ex(!eh),"aria-label":"Buscar productos",children:(0,t.jsx)(eS.A,{className:"h-5 w-5"})}),(0,t.jsxs)(eM,{children:[(0,t.jsx)(eO,{asChild:!0,children:(0,t.jsx)(S.$,{variant:"ghost",size:"icon",className:"h-9 w-9",children:(0,t.jsx)(eP.A,{className:"h-5 w-5"})})}),(0,t.jsxs)(eq,{align:"end",children:[(0,t.jsx)(()=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eZ,{children:"Opciones de Vista"}),(0,t.jsx)(eJ,{}),(0,t.jsxs)(eH,{onClick:aO,children:["desc"===er.order?(0,t.jsx)(eg.A,{className:"mr-2"}):(0,t.jsx)(ej.A,{className:"mr-2"}),(0,t.jsx)("span",{children:"Ordenar por Nombre"})]}),(0,t.jsxs)(eH,{onClick:()=>ea(e=>"list"===e?"grid":"list"),children:["list"===ee?(0,t.jsx)(ev.A,{className:"mr-2"}):(0,t.jsx)(ey.A,{className:"mr-2"}),(0,t.jsx)("span",{children:"list"===ee?"Vista de Cuadr\xedcula":"Vista de Lista"})]}),(0,t.jsx)(eJ,{}),(0,t.jsxs)("div",{className:"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-2 text-sm outline-none",children:[(0,t.jsxs)(U,{htmlFor:"group-by-category-mobile",className:"flex items-center gap-2 flex-grow pr-2",children:[(0,t.jsx)(em.A,{className:"h-4 w-4"})," ",(0,t.jsx)("span",{children:"Agrupar"})]}),(0,t.jsx)(eT,{id:"group-by-category-mobile",checked:es,onCheckedChange:et})]})]}),{}),(0,t.jsx)(eJ,{}),(0,t.jsx)(aW,{})]})]})]})]}),(0,t.jsxs)("div",{className:"hidden sm:flex items-center gap-2",children:[(0,t.jsx)(S.$,{variant:"ghost",size:"icon",className:"h-9 w-9",onClick:()=>ex(!eh),"aria-label":"Buscar productos",children:(0,t.jsx)(eS.A,{className:"h-5 w-5"})}),(0,t.jsxs)(eM,{children:[(0,t.jsx)(eO,{asChild:!0,children:(0,t.jsx)(S.$,{variant:"ghost",size:"icon",className:"h-9 w-9",children:(0,t.jsx)(eE.A,{className:"h-5 w-5"})})}),(0,t.jsx)(eq,{align:"end",children:(0,t.jsx)(aW,{})})]}),(0,t.jsxs)(e1,{children:[(0,t.jsxs)(e5,{children:[(0,t.jsx)(e8,{asChild:!0,children:(0,t.jsx)(S.$,{variant:"name"===er.by?"secondary":"ghost",size:"icon",className:"h-9 w-9",onClick:aO,"aria-label":"Ordenar por nombre",children:"desc"===er.order?(0,t.jsx)(eg.A,{className:"h-5 w-5"}):(0,t.jsx)(ej.A,{className:"h-5 w-5"})})}),(0,t.jsx)(e3,{children:(0,t.jsxs)("p",{children:["Ordenar por Nombre (","asc"===er.order?"A-Z":"Z-A",")"]})})]}),(0,t.jsxs)(e5,{children:[(0,t.jsx)(e8,{asChild:!0,children:(0,t.jsx)(S.$,{variant:"ghost",size:"icon",className:"h-9 w-9",onClick:()=>ea(e=>"list"===e?"grid":"list"),"aria-label":"Cambiar vista",children:"list"===ee?(0,t.jsx)(ev.A,{className:"h-5 w-5"}):(0,t.jsx)(ey.A,{className:"h-5 w-5"})})}),(0,t.jsx)(e3,{children:(0,t.jsx)("p",{children:"list"===ee?"Vista de Cuadr\xedcula":"Vista de Lista"})})]})]}),(0,t.jsxs)(U,{htmlFor:"group-by-category",className:(0,v.cn)("flex cursor-pointer items-center gap-2 rounded-md px-3 h-9 text-sm font-medium ring-offset-background transition-colors",es?"bg-accent text-accent-foreground shadow-sm":"border border-white/30 bg-secondary/50 text-foreground hover:bg-accent hover:text-accent-foreground"),children:[(0,t.jsx)("span",{children:"Agrupar"}),(0,t.jsx)(eT,{id:"group-by-category",checked:es,onCheckedChange:et})]}),(0,t.jsx)(ar,{orientation:"vertical",className:"h-6 mx-1"}),(0,t.jsx)(e1,{children:(0,t.jsxs)(e5,{children:[(0,t.jsx)(e8,{asChild:!0,children:(0,t.jsx)(S.$,{size:"icon",className:"h-9 w-9",onClick:()=>ez(!0),"aria-label":"A\xf1adir producto con foto",children:(0,t.jsx)(z.A,{className:"h-5 w-5"})})}),(0,t.jsx)(e3,{children:(0,t.jsx)("p",{children:"A\xf1adir producto con foto"})})]})})]})]}),(0,t.jsx)(e2.N,{children:eh&&(0,t.jsxs)(e0.P.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"relative mt-4",children:[(0,t.jsx)(eS.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),(0,t.jsx)(eR,{type:"text",placeholder:"Buscar productos...",className:"pl-10 w-full bg-gray-800 text-white placeholder-gray-400",value:ec,onChange:e=>eu(e.target.value)}),(0,t.jsx)(S.$,{variant:"ghost",size:"icon",className:"absolute right-1 top-1/2 -translate-y-1/2 h-8 w-8",onClick:()=>ex(!1),children:(0,t.jsx)(j.A,{className:"h-4 w-4"})})]})}),(0,t.jsx)(al,{onAddItem:aK,history:M,pantry:_,shoppingList:D,activeTab:N})]}),(0,t.jsx)(eX,{value:"pantry",children:(0,t.jsx)("div",{className:"mt-6",children:_.length>0?aU.length>0?es?(0,t.jsx)(e7,{type:"multiple",value:ax,onValueChange:af,className:"w-full space-y-2",children:(0,t.jsx)(e2.N,{children:aH.map(e=>(null==aq?void 0:aq[e])&&(0,t.jsxs)(ae,{value:e,className:"border-none",children:[(0,t.jsx)(aa,{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wider hover:no-underline rounded-md p-2",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[an[e]," ",e]})}),(0,t.jsx)(as,{children:(0,t.jsx)("div",{className:(0,v.cn)("gap-2 pt-2","grid"===ee?"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4":"flex flex-col"),children:(0,t.jsx)(e2.N,{children:((null==aq?void 0:aq[e])||[]).map(e=>(0,t.jsx)(ao,{product:e,viewMode:ee,isPulsing:e.id===eU,isExiting:e.id===eB,onUpdateStatus:aP,onDelete:()=>ed(e.id),onAddToShoppingList:aI,onUpdateCategory:aE,onEdit:aN},"pantry-grouped-".concat(e.id)))})})}),(0,t.jsx)(ar,{className:"mt-2"})]},"pantry-cat-".concat(e)))})}):(0,t.jsx)("div",{className:(0,v.cn)("gap-2","grid"===ee?"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4":"flex flex-col"),children:(0,t.jsx)(e2.N,{children:aU.map(e=>(0,t.jsx)(ao,{product:e,viewMode:ee,isPulsing:e.id===eU,isExiting:e.id===eB,onUpdateStatus:aP,onDelete:()=>ed(e.id),onAddToShoppingList:aI,onUpdateCategory:aE,onEdit:aN},"pantry-".concat(e.id)))})}):(0,t.jsx)("div",{className:"text-center py-10 bg-card rounded-lg",children:(0,t.jsx)("p",{className:"text-muted-foreground",children:"No se encontraron productos con los filtros actuales."})}):(0,t.jsx)("div",{className:"text-center py-10 bg-card rounded-lg",children:(0,t.jsx)("p",{className:"text-muted-foreground",children:"Tu despensa est\xe1 vac\xeda. \xa1A\xf1ade algunos productos!"})})})}),(0,t.jsx)(eX,{value:"shopping-list",children:0===D.length?(0,t.jsx)("div",{className:"text-center py-10 bg-card rounded-lg mt-6",children:(0,t.jsx)("p",{className:"text-muted-foreground",children:"\xa1Tu lista de compra est\xe1 vac\xeda!"})}):(0,t.jsx)(t.Fragment,{children:0===a$.length?(0,t.jsx)("div",{className:"text-center py-10 bg-card rounded-lg mt-6",children:(0,t.jsx)("p",{className:"text-muted-foreground",children:"No se encontraron productos con los filtros actuales."})}):(0,t.jsxs)(t.Fragment,{children:[aV.length>0&&(0,t.jsxs)("div",{className:"mt-6",children:[(0,t.jsxs)("h2",{className:"mb-4 text-lg font-semibold tracking-tight",children:["Para comprar ahora (",aV.length,")"]}),es?(0,t.jsx)(e7,{type:"multiple",value:ag,onValueChange:aj,className:"w-full space-y-2",children:(0,t.jsx)(e2.N,{children:aZ.filter(e=>null==aG?void 0:aG[e]).map(e=>(0,t.jsxs)(ae,{value:e,className:"border-none",children:[(0,t.jsx)(aa,{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wider hover:no-underline rounded-md p-2",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[an[e]," ",e]})}),(0,t.jsx)(as,{children:(0,t.jsx)("div",{className:(0,v.cn)("gap-2 pt-2","grid"===ee?"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4":"flex flex-col"),children:(0,t.jsx)(e2.N,{children:((null==aG?void 0:aG[e])||[]).map(e=>(0,t.jsx)(ad,{layoutId:"shopping-now-grouped-".concat(e.id),item:e,viewMode:ee,onCardClick:aT,onToggleBuyLater:a_,onDelete:()=>ed(e.id),onReturnToPantry:aD,onEdit:aN,isChecking:e.id===e4,isSliding:e.id===e6},"shopping-now-grouped-".concat(e.id)))})})}),(0,t.jsx)(ar,{className:"mt-2"})]},"shopping-now-cat-".concat(e)))})}):(0,t.jsx)("div",{className:(0,v.cn)("gap-2","grid"===ee?"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4":"flex flex-col"),children:(0,t.jsx)(e2.N,{children:aV.map(e=>(0,t.jsx)(ad,{layoutId:"shopping-now-".concat(e.id),item:e,viewMode:ee,onCardClick:aT,onToggleBuyLater:a_,onDelete:()=>ed(e.id),onReturnToPantry:aD,onEdit:aN,isChecking:e.id===e4,isSliding:e.id===e6},"shopping-now-".concat(e.id)))})})]}),aB.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ar,{className:"my-8"}),(0,t.jsx)(e7,{type:"multiple",value:ag,onValueChange:aj,className:"w-full",children:(0,t.jsxs)(ae,{value:"buy-later-section",className:"border-none",children:[(0,t.jsx)(aa,{className:"hover:no-underline",children:(0,t.jsxs)("h2",{className:"text-lg font-semibold tracking-tight text-foreground",children:["Comprar otro d\xeda (",aB.length,")"]})}),(0,t.jsx)(as,{className:"pt-4",children:es?(0,t.jsx)(e7,{type:"multiple",value:ag,onValueChange:aj,className:"w-full space-y-2",children:(0,t.jsx)(e2.N,{children:aY.filter(e=>null==aJ?void 0:aJ[e]).map(e=>(0,t.jsxs)(ae,{value:e,className:"border-none",children:[(0,t.jsx)(aa,{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wider hover:no-underline rounded-md p-2",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[an[e]," ",e]})}),(0,t.jsx)(as,{children:(0,t.jsx)("div",{className:(0,v.cn)("gap-2 pt-2","grid"===ee?"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4":"flex flex-col"),children:(0,t.jsx)(e2.N,{children:((null==aJ?void 0:aJ[e])||[]).map(e=>(0,t.jsx)(ad,{layoutId:"shopping-later-grouped-".concat(e.id),item:e,viewMode:ee,onCardClick:aT,onToggleBuyLater:a_,onDelete:()=>ed(e.id),onReturnToPantry:aD,onEdit:aN,isChecking:e.id===e4,isSliding:e.id===e6},"shopping-later-grouped-".concat(e.id)))})})}),(0,t.jsx)(ar,{className:"mt-2"})]},"shopping-later-cat-".concat(e)))})}):(0,t.jsx)("div",{className:(0,v.cn)("gap-2","grid"===ee?"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4":"flex flex-col"),children:(0,t.jsx)(e2.N,{children:aB.map(e=>(0,t.jsx)(ad,{layoutId:"shopping-later-".concat(e.id),item:e,viewMode:ee,onCardClick:aT,onToggleBuyLater:a_,onDelete:()=>ed(e.id),onReturnToPantry:aD,onEdit:aN,isChecking:e.id===e4,isSliding:e.id===e6},"shopping-later-".concat(e.id)))})})})]})})]})]})})})]})}),(0,t.jsx)(B,{open:eI,onOpenChange:e_,pantry:_,shoppingList:D}),(0,t.jsx)($,{open:ef,onOpenChange:ez,onAddProducts:J}),(0,t.jsx)(y,{open:!!eo,onOpenChange:()=>ed(null),children:(0,t.jsxs)(w,{children:[(0,t.jsxs)(C,{children:[(0,t.jsxs)(A,{className:"flex items-center gap-2",children:[(0,t.jsx)(E.A,{className:"text-destructive"}),"\xbfEst\xe1s seguro?"]}),(0,t.jsx)(L,{children:"Esta acci\xf3n no se puede deshacer. Esto eliminar\xe1 permanentemente el producto."})]}),(0,t.jsxs)(k,{children:[(0,t.jsx)(S.$,{variant:"outline",onClick:()=>ed(null),children:"Cancelar"}),(0,t.jsx)(S.$,{variant:"destructive",className:"bg-[#2C0000] text-white hover:bg-[#2C0000]/90",onClick:()=>eo&&aR(eo),children:"Eliminar"})]})]})}),(0,t.jsx)(y,{open:eD,onOpenChange:eF,children:(0,t.jsxs)(w,{children:[(0,t.jsxs)(C,{children:[(0,t.jsx)(A,{children:"Leyenda de Colores"}),(0,t.jsx)(L,{children:"Los colores del borde de cada producto te ayudan a conocer su estado de un vistazo."})]}),(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"h-4 w-4 rounded-full bg-verde-eucalipto shrink-0 border"}),(0,t.jsxs)("p",{className:"text-sm",children:[(0,t.jsx)("b",{children:"Verde:"})," Producto disponible en tu despensa."]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"h-4 w-4 rounded-full bg-amarillo-mostaza shrink-0 border"}),(0,t.jsxs)("p",{className:"text-sm",children:[(0,t.jsx)("b",{children:"\xc1mbar:"})," Queda poca cantidad del producto."]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"h-4 w-4 rounded-full bg-rojo-coral shrink-0 border"}),(0,t.jsxs)("p",{className:"text-sm",children:[(0,t.jsx)("b",{children:"Rojo:"})," Producto agotado o que necesitas comprar."]})]})]}),(0,t.jsx)(k,{children:(0,t.jsx)(S.$,{onClick:()=>eF(!1),children:"Entendido"})})]})}),(0,t.jsx)(y,{open:ai,onOpenChange:ac,children:(0,t.jsxs)(w,{className:"max-w-lg",children:[(0,t.jsxs)(C,{children:[(0,t.jsx)(A,{children:"Receta Sugerida"}),(0,t.jsx)(L,{children:ap&&!au?"Buscando una receta deliciosa con tus ingredientes...":au?au.title:""})]}),ap?(0,t.jsx)("div",{className:"flex justify-center items-center py-10",children:(0,t.jsx)(R.A,{className:"h-10 w-10 animate-spin text-primary"})}):au?(0,t.jsxs)("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto pr-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold mb-2 text-primary",children:"Ingredientes"}),(0,t.jsx)("ul",{className:"list-disc list-inside space-y-1 text-sm",children:au.ingredients.map((e,a)=>(0,t.jsx)("li",{children:e},"recipe-ing-".concat(a,"-").concat(e)))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold mb-2 text-primary",children:"Instrucciones"}),(0,t.jsx)("ol",{className:"list-decimal list-inside space-y-2 text-sm",children:au.instructions.map((e,a)=>(0,t.jsx)("li",{children:e},"recipe-step-".concat(a)))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold mb-2 text-primary",children:"Nota del Chef"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground italic",children:au.note})]})]}):(0,t.jsx)("div",{className:"text-center py-10",children:(0,t.jsx)("p",{className:"text-muted-foreground",children:"No se pudo generar la receta. Int\xe9ntalo de nuevo."})}),(0,t.jsxs)(k,{className:"flex-row justify-between sm:justify-between w-full",children:[(0,t.jsx)(S.$,{variant:"outline",onClick:()=>ac(!1),children:"Cerrar"}),(0,t.jsxs)(S.$,{variant:"secondary",onClick:aM,disabled:ap,children:[ap?(0,t.jsx)(R.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,t.jsx)(I.A,{className:"mr-2 h-4 w-4"}),"Probar otra"]})]})]})}),(0,t.jsx)(y,{open:!!ab,onOpenChange:()=>aN(null),children:(0,t.jsxs)(w,{children:[(0,t.jsxs)(C,{children:[(0,t.jsx)(A,{children:"Editar nombre del producto"}),(0,t.jsxs)(L,{children:['Cambia el nombre de "',null==ab?void 0:ab.name,'" y pulsa guardar.']})]}),(0,t.jsxs)("div",{className:"pt-4",children:[(0,t.jsx)(U,{htmlFor:"product-name-edit",className:"sr-only",children:"Nuevo nombre"}),(0,t.jsx)(eR,{id:"product-name-edit",value:aw,onChange:e=>aC(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),ak())},placeholder:"Nuevo nombre del producto",className:"bg-gray-800 text-white placeholder-gray-400"})]}),(0,t.jsxs)(k,{children:[(0,t.jsx)(S.$,{variant:"outline",onClick:()=>aN(null),children:"Cancelar"}),(0,t.jsx)(S.$,{onClick:ak,children:"Guardar cambios"})]})]})})]})}},7481:(e,a,s)=>{"use strict";s.d(a,{dj:()=>m,oR:()=>u});var t=s(2115);let r=0,i=new Map,n=e=>{if(i.has(e))return;let a=setTimeout(()=>{i.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);i.set(e,a)},l=(e,a)=>{switch(a.type){case"ADD_TOAST":return{...e,toasts:[a.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===a.toast.id?{...e,...a.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=a;return s?n(s):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===a.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==a.toastId)}}},o=[],d={toasts:[]};function c(e){d=l(d,e),o.forEach(e=>{e(d)})}function u(e){let{...a}=e,s=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),t=()=>c({type:"DISMISS_TOAST",toastId:s});return c({type:"ADD_TOAST",toast:{...a,id:s,open:!0,onOpenChange:e=>{e||t()}}}),{id:s,dismiss:t,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function m(){let[e,a]=t.useState(d);return t.useEffect(()=>(o.push(a),()=>{let e=o.indexOf(a);e>-1&&o.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},9434:(e,a,s)=>{"use strict";s.d(a,{cn:()=>i});var t=s(2596),r=s(9688);function i(){for(var e=arguments.length,a=Array(e),s=0;s<e;s++)a[s]=arguments[s];return(0,r.QP)((0,t.$)(a))}}},e=>{var a=a=>e(e.s=a);e.O(0,[992,416,755,869,426,441,684,358],()=>a(6773)),_N_E=e.O()}]);